---
layout: post
title: "利用redis实现红包"
date: 2017-09-01 11:00:00 +0800 
categories: 分类
tag: [redis]
---
* content
{:toc}

这篇博客主要是对之前工作中对红包功能实现的总结，记录学习过程，也供各位网友参考，如有设计以及实现上的缺陷，或是存在漏洞，请大家批评指正！

<!-- more -->
<!-- TOC -->
## 需求
    1 红包发送    
2 红包接收    
3 过期红包回收    
4 红包记录查询    

目前的设计是在红包发出去就分配好

## 数据库
    +redis：list存分开的小红包，hash存领取情况  
        -list：key为红包id，各个值为小红包金额  
        -hash:key为红包id，field为用户id，value为用户抢到的金额  
    +mysql或postgresql等数据库
        -红包发送表：红包id，发送者id，金额，是否抢完，是否到期等
        -红包分配表：红包id，抢到的用户id，金额

## 红包发送
![红包发送流程图](/img_blog/2017-09-01-1.jpg)
